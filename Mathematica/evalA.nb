(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10322,        298]
NotebookOptionsPosition[     10004,        283]
NotebookOutlinePosition[     10361,        299]
CellTagsIndexPosition[     10318,        296]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Define", " ", "scaling", " ", "functions", " ", "on", " ", "level", " ", 
    "0", " ", "and", " ", "wavelet", " ", "functions", " ", "on", " ", 
    "level", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Phi0", "[", "x_", "]"}], " ", ":=", " ", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", 
          RowBox[{
          "0", " ", "\[LessEqual]", " ", "x", " ", "\[LessEqual]", " ", 
           "1"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "True"}], "}"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Phi1", "[", "x_", "]"}], " ", ":=", " ", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", "3", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "x"}], " ", "-", " ", "1"}], ")"}]}], ",", " ", 
          RowBox[{
          "0", " ", "\[LessEqual]", " ", "x", " ", "\[LessEqual]", " ", 
           "1"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "True"}], "}"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psi0", "[", "x_", "]"}], " ", ":=", " ", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"6", "x"}]}], ",", 
          RowBox[{
          "0", " ", "\[LessEqual]", " ", "x", " ", "\[LessEqual]", "  ", 
           RowBox[{"1", "/", "2"}]}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"5", " ", "-", " ", 
           RowBox[{"6", "x"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "2"}], " ", "<", " ", "x", " ", "\[LessEqual]", 
           " ", "1"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "True"}], "}"}]}], "}"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Psi1", "[", "x_", "]"}], " ", ":=", " ", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", "3", "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"4", "*", "x"}]}], ")"}]}], ",", 
          RowBox[{
          "0", " ", "\[LessEqual]", " ", "x", " ", "\[LessEqual]", "  ", 
           RowBox[{"1", "/", "2"}]}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", "3", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", "x"}], " ", "-", " ", "3"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "2"}], " ", "<", " ", "x", " ", "\[LessEqual]", 
           " ", "1"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "True"}], "}"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Define", " ", "scaling", " ", "and", " ", "wavelet", " ", "functions", 
     " ", "on", " ", "level", " ", "n"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Psi0n", "[", 
     RowBox[{"x_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", " ", "\[Equal]", " ", "0"}], ",", 
      RowBox[{"Phi0", "[", "x", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], ")"}]}], " ", 
       RowBox[{"Psi0", "[", 
        RowBox[{
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}], " ", "x"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psi1n", "[", 
     RowBox[{"x_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", " ", "\[Equal]", " ", "0"}], ",", 
      RowBox[{"Phi1", "[", "x", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], ")"}]}], " ", 
       RowBox[{"Psi1", "[", 
        RowBox[{
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}], " ", "x"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Phi0n", "[", 
     RowBox[{"x_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Phi0", "[", 
     RowBox[{
      RowBox[{"2", "^", "n"}], " ", "x"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Phi1n", "[", 
     RowBox[{"x_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Phi1", "[", 
     RowBox[{
      RowBox[{"2", "^", "n"}], " ", "x"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psi00", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Psi0n", "[", 
     RowBox[{"x", ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psi10", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Psi1n", "[", 
     RowBox[{"x", ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psi01", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Psi0n", "[", 
     RowBox[{"x", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psi11", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Psi1n", "[", 
     RowBox[{"x", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psi02", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Psi0n", "[", 
     RowBox[{"x", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psi12", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Psi1n", "[", 
     RowBox[{"x", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psi22", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Psi0n", "[", 
     RowBox[{
      RowBox[{"x", "-", 
       RowBox[{"1", "/", "2"}]}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Psi32", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Psi1n", "[", 
     RowBox[{
      RowBox[{"x", "-", 
       RowBox[{"1", "/", "2"}]}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Psi03", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Psi0n", "[", 
     RowBox[{"x", ",", "3"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psi13", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Psi1n", "[", 
     RowBox[{"x", ",", "3"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Phi01", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Phi0n", "[", 
     RowBox[{"x", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Phi11", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Phi1n", "[", 
     RowBox[{"x", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Ensure", " ", "that", " ", "the", " ", "multiscale", " ", "mass", " ", 
     "matrix", " ", "is", " ", "the", " ", "identity"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Integrate", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"fn1", "[", "x", "]"}], " ", "*", " ", 
        RowBox[{"fn2", "[", "x", "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"fn1", ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "Psi00", ",", " ", "Psi10", ",", " ", "Psi01", ",", " ", "Psi11", ",",
          " ", "Psi02", ",", " ", "Psi12", ",", " ", "Psi03", ",", " ", 
         "Psi13"}], "}"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"fn2", ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "Psi00", ",", " ", "Psi10", ",", " ", "Psi01", ",", " ", "Psi11", ",",
          " ", "Psi02", ",", " ", "Psi12", ",", " ", "Psi03", ",", " ", 
         "Psi13"}], "}"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Compute", " ", "multiscale", " ", "damping", " ", "matrix"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"TableForm", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"fn1", "[", "x", "]"}], " ", "*", 
         RowBox[{"D", "[", " ", 
          RowBox[{
           RowBox[{"fn2", "[", "x", "]"}], ",", "x"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"fn1", ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "Psi00", ",", " ", "Psi10", ",", " ", "Psi01", ",", " ", "Psi11", 
          ",", "Psi02", ",", " ", "Psi12", ",", " ", "Psi22", ",", " ", 
          "Psi32"}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"fn2", ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "Psi00", ",", " ", "Psi10", ",", " ", "Psi01", ",", " ", "Psi11", 
          ",", "Psi02", ",", " ", "Psi12", ",", " ", "Psi22", ",", " ", 
          "Psi32"}], "}"}]}], "}"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.772772832936942*^9, 
  3.7727728609385567`*^9}},ExpressionUUID->"baa14fd5-e0d6-44ee-ae13-\
a3828c2fe6b8"]
},
WindowSize->{808, 911},
WindowMargins->{{Automatic, 509}, {Automatic, 167}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 16, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 9442, 261, 705, "Input", "ExpressionUUID" -> \
"baa14fd5-e0d6-44ee-ae13-a3828c2fe6b8"]
}
]
*)

(* End of internal cache information *)


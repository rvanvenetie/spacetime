#pragma once

#include "integration.hpp"

namespace space {
template <unsigned P>
template <class F>
double IntegrationRule<P>::Integrate(F f, const Element2D &elem) {
  double integral = 0.0;
  for (const auto [p, q, w] : rule) {
    auto [x, y] = elem.GlobalCoordinates(p, q);
    integral += w * f(x, y);
  }
  return elem.area() * integral;
}
};  // namespace space
namespace space {
template <>
std::vector<std::tuple<double, double, double>> IntegrationRule<0>::rule{
	{0.33333333333333331483,0.33333333333333331483,1.00000000000000000000},};
template <>
std::vector<std::tuple<double, double, double>> IntegrationRule<1>::rule{
	{0.25000000000000000000,0.50000000000000000000,0.33333333333333325932},
	{0.50000000000000000000,0.25000000000000000000,0.33333333333333325932},
	{0.25000000000000000000,0.25000000000000000000,0.33333333333333325932},};
template <>
std::vector<std::tuple<double, double, double>> IntegrationRule<2>::rule{
	{0.20000000000000001110,0.59999999999999997780,0.58333333333333325932},
	{0.40000000000000002220,0.40000000000000002220,-0.25000000000000000000},
	{0.59999999999999997780,0.20000000000000001110,0.58333333333333325932},
	{0.20000000000000001110,0.40000000000000002220,-0.25000000000000000000},
	{0.40000000000000002220,0.20000000000000001110,-0.25000000000000000000},
	{0.20000000000000001110,0.20000000000000001110,0.58333333333333325932},};
template <>
std::vector<std::tuple<double, double, double>> IntegrationRule<3>::rule{
	{0.16666666666666665741,0.66666666666666662966,0.26666666666666638541},
	{0.33333333333333331483,0.50000000000000000000,0.09999999999999964473},
	{0.50000000000000000000,0.33333333333333331483,0.09999999999999964473},
	{0.66666666666666662966,0.16666666666666665741,0.26666666666666638541},
	{0.16666666666666665741,0.50000000000000000000,0.09999999999999964473},
	{0.33333333333333331483,0.33333333333333331483,-0.39999999999999991118},
	{0.50000000000000000000,0.16666666666666665741,0.09999999999999964473},
	{0.16666666666666665741,0.33333333333333331483,0.09999999999999964473},
	{0.33333333333333331483,0.16666666666666665741,0.09999999999999964473},
	{0.16666666666666665741,0.16666666666666665741,0.26666666666666638541},};
template <>
std::vector<std::tuple<double, double, double>> IntegrationRule<4>::rule{
	{0.14285714285714284921,0.71428571428571430157,0.42638888888888992756},
	{0.28571428571428569843,0.57142857142857139685,-0.43888888888889088236},
	{0.42857142857142854764,0.42857142857142854764,0.87361111111111178218},
	{0.57142857142857139685,0.28571428571428569843,-0.43888888888889043827},
	{0.71428571428571430157,0.14285714285714284921,0.42638888888888992756},
	{0.14285714285714284921,0.57142857142857139685,-0.43888888888889088236},
	{0.28571428571428569843,0.42857142857142854764,-0.08888888888888901718},
	{0.42857142857142854764,0.28571428571428569843,-0.08888888888888901718},
	{0.57142857142857139685,0.14285714285714284921,-0.43888888888889088236},
	{0.14285714285714284921,0.42857142857142854764,0.87361111111111178218},
	{0.28571428571428569843,0.28571428571428569843,-0.08888888888889034945},
	{0.42857142857142854764,0.14285714285714284921,0.87361111111111178218},
	{0.14285714285714284921,0.28571428571428569843,-0.43888888888889043827},
	{0.28571428571428569843,0.14285714285714284921,-0.43888888888889043827},
	{0.14285714285714284921,0.14285714285714284921,0.42638888888888992756},};
template <>
std::vector<std::tuple<double, double, double>> IntegrationRule<5>::rule{
	{0.12500000000000000000,0.75000000000000000000,0.22539682539682903695},
	{0.25000000000000000000,0.62500000000000000000,-0.04126984126984023504},
	{0.37500000000000000000,0.50000000000000000000,0.18095238095238119769},
	{0.50000000000000000000,0.37500000000000000000,0.18095238095238386222},
	{0.62500000000000000000,0.25000000000000000000,-0.04126984126983801460},
	{0.75000000000000000000,0.12500000000000000000,0.22539682539682903695},
	{0.12500000000000000000,0.62500000000000000000,-0.04126984126984023504},
	{0.25000000000000000000,0.50000000000000000000,-0.53015873015873093976},
	{0.37500000000000000000,0.37500000000000000000,0.35873015873016012023},
	{0.50000000000000000000,0.25000000000000000000,-0.53015873015873227203},
	{0.62500000000000000000,0.12500000000000000000,-0.04126984126984023504},
	{0.12500000000000000000,0.50000000000000000000,0.18095238095238119769},
	{0.25000000000000000000,0.37500000000000000000,0.35873015873016056432},
	{0.37500000000000000000,0.25000000000000000000,0.35873015873016056432},
	{0.50000000000000000000,0.12500000000000000000,0.18095238095238119769},
	{0.12500000000000000000,0.37500000000000000000,0.18095238095238386222},
	{0.25000000000000000000,0.25000000000000000000,-0.53015873015872916341},
	{0.37500000000000000000,0.12500000000000000000,0.18095238095238386222},
	{0.12500000000000000000,0.25000000000000000000,-0.04126984126983801460},
	{0.25000000000000000000,0.12500000000000000000,-0.04126984126983801460},
	{0.12500000000000000000,0.12500000000000000000,0.22539682539682903695},};
template <>
std::vector<std::tuple<double, double, double>> IntegrationRule<6>::rule{
	{0.11111111111111110494,0.77777777777777779011,0.34241071428568747859},
	{0.22222222222222220989,0.66666666666666662966,-0.56116071428571467905},
	{0.33333333333333331483,0.55555555555555558023,1.29508928571428860721},
	{0.44444444444444441977,0.44444444444444441977,-1.35491071428570286628},
	{0.55555555555555558023,0.33333333333333331483,1.29508928571429304810},
	{0.66666666666666662966,0.22222222222222220989,-0.56116071428571956403},
	{0.77777777777777779011,0.11111111111111110494,0.34241071428568747859},
	{0.11111111111111110494,0.66666666666666662966,-0.56116071428571467905},
	{0.22222222222222220989,0.55555555555555558023,0.17276785714285647355},
	{0.33333333333333331483,0.44444444444444441977,-0.40848214285715123140},
	{0.44444444444444441977,0.33333333333333331483,-0.40848214285715300775},
	{0.55555555555555558023,0.22222222222222220989,0.17276785714284892403},
	{0.66666666666666662966,0.11111111111111110494,-0.56116071428571467905},
	{0.11111111111111110494,0.55555555555555558023,1.29508928571428860721},
	{0.22222222222222220989,0.44444444444444441977,-0.40848214285715123140},
	{0.33333333333333331483,0.33333333333333331483,1.56651785714284841333},
	{0.44444444444444441977,0.22222222222222220989,-0.40848214285715300775},
	{0.55555555555555558023,0.11111111111111110494,1.29508928571428860721},
	{0.11111111111111110494,0.44444444444444441977,-1.35491071428570286628},
	{0.22222222222222220989,0.33333333333333331483,-0.40848214285715123140},
	{0.33333333333333331483,0.22222222222222220989,-0.40848214285715123140},
	{0.44444444444444441977,0.11111111111111110494,-1.35491071428570286628},
	{0.11111111111111110494,0.33333333333333331483,1.29508928571429304810},
	{0.22222222222222220989,0.22222222222222220989,0.17276785714284847995},
	{0.33333333333333331483,0.11111111111111110494,1.29508928571429304810},
	{0.11111111111111110494,0.22222222222222220989,-0.56116071428571956403},
	{0.22222222222222220989,0.11111111111111110494,-0.56116071428571956403},
	{0.11111111111111110494,0.11111111111111110494,0.34241071428568747859},};
template <>
std::vector<std::tuple<double, double, double>> IntegrationRule<7>::rule{
	{0.10000000000000000555,0.80000000000000004441,0.19797178130511361438},
	{0.20000000000000001110,0.69999999999999995559,-0.14594356261023211374},
	{0.29999999999999998890,0.59999999999999997780,0.34678130511457561092},
	{0.40000000000000002220,0.50000000000000000000,-0.04210758377426393473},
	{0.50000000000000000000,0.40000000000000002220,-0.04210758377426482291},
	{0.59999999999999997780,0.29999999999999998890,0.34678130511457028184},
	{0.69999999999999995559,0.20000000000000001110,-0.14594356261022811694},
	{0.80000000000000004441,0.10000000000000000555,0.19797178130511361438},
	{0.10000000000000000555,0.69999999999999995559,-0.14594356261023211374},
	{0.20000000000000001110,0.59999999999999997780,-0.55599647266315743721},
	{0.29999999999999998890,0.50000000000000000000,0.65895061728390702527},
	{0.40000000000000002220,0.40000000000000002220,-1.26234567901231642395},
	{0.50000000000000000000,0.29999999999999998890,0.65895061728394699330},
	{0.59999999999999997780,0.20000000000000001110,-0.55599647266314455862},
	{0.69999999999999995559,0.10000000000000000555,-0.14594356261023211374},
	{0.10000000000000000555,0.59999999999999997780,0.34678130511457561092},
	{0.20000000000000001110,0.50000000000000000000,0.65895061728390702527},
	{0.29999999999999998890,0.40000000000000002220,0.31834215167551604964},
	{0.40000000000000002220,0.29999999999999998890,0.31834215167545920622},
	{0.50000000000000000000,0.20000000000000001110,0.65895061728394477285},
	{0.59999999999999997780,0.10000000000000000555,0.34678130511457561092},
	{0.10000000000000000555,0.50000000000000000000,-0.04210758377426393473},
	{0.20000000000000001110,0.40000000000000002220,-1.26234567901231820031},
	{0.29999999999999998890,0.29999999999999998890,0.31834215167547696979},
	{0.40000000000000002220,0.20000000000000001110,-1.26234567901236793830},
	{0.50000000000000000000,0.10000000000000000555,-0.04210758377426393473},
	{0.10000000000000000555,0.40000000000000002220,-0.04210758377426482291},
	{0.20000000000000001110,0.29999999999999998890,0.65895061728393544698},
	{0.29999999999999998890,0.20000000000000001110,0.65895061728394299649},
	{0.40000000000000002220,0.10000000000000000555,-0.04210758377426482291},
	{0.10000000000000000555,0.29999999999999998890,0.34678130511457028184},
	{0.20000000000000001110,0.20000000000000001110,-0.55599647266316365446},
	{0.29999999999999998890,0.10000000000000000555,0.34678130511457028184},
	{0.10000000000000000555,0.20000000000000001110,-0.14594356261022811694},
	{0.20000000000000001110,0.10000000000000000555,-0.14594356261022811694},
	{0.10000000000000000555,0.10000000000000000555,0.19797178130511361438},};
template <>
std::vector<std::tuple<double, double, double>> IntegrationRule<8>::rule{
	{0.09090909090909091161,0.81818181818181823228,0.28975005511461682239},
	{0.18181818181818182323,0.72727272727272729291,-0.65220072751305069314},
	{0.27272727272727270709,0.63636363636363635354,1.78954888668424128007},
	{0.36363636363636364646,0.54545454545454541417,-2.75199487433859335539},
	{0.45454545454545453032,0.45454545454545453032,3.40830219356252062113},
	{0.54545454545454541417,0.36363636363636364646,-2.75199487433857825636},
	{0.63636363636363635354,0.27272727272727270709,1.78954888668425371456},
	{0.72727272727272729291,0.18181818181818182323,-0.65220072751311242154},
	{0.81818181818181823228,0.09090909090909091161,0.28975005511461682239},
	{0.09090909090909091161,0.72727272727272729291,-0.65220072751305069314},
	{0.18181818181818182323,0.63636363636363635354,0.50102899029964653721},
	{0.27272727272727270709,0.54545454545454541417,-1.03533041225748156933},
	{0.36363636363636364646,0.45454545454545453032,0.13179480820098898874},
	{0.45454545454545453032,0.36363636363636364646,0.13179480820085043291},
	{0.54545454545454541417,0.27272727272727270709,-1.03533041225742916680},
	{0.63636363636363635354,0.18181818181818182323,0.50102899029960523691},
	{0.72727272727272729291,0.09090909090909091161,-0.65220072751305069314},
	{0.09090909090909091161,0.63636363636363635354,1.78954888668424128007},
	{0.18181818181818182323,0.54545454545454541417,-1.03533041225745314762},
	{0.27272727272727270709,0.45454545454545453032,2.94464891975302300864},
	{0.36363636363636364646,0.36363636363636364646,-1.77403218694894615481},
	{0.45454545454545453032,0.27272727272727270709,2.94464891975300879778},
	{0.54545454545454541417,0.18181818181818182323,-1.03533041225736610613},
	{0.63636363636363635354,0.09090909090909091161,1.78954888668424128007},
	{0.09090909090909091161,0.54545454545454541417,-2.75199487433859335539},
	{0.18181818181818182323,0.45454545454545453032,0.13179480820098188332},
	{0.27272727272727270709,0.36363636363636364646,-1.77403218694898523466},
	{0.36363636363636364646,0.27272727272727270709,-1.77403218694897013563},
	{0.45454545454545453032,0.18181818181818182323,0.13179480820085531789},
	{0.54545454545454541417,0.09090909090909091161,-2.75199487433859335539},
	{0.09090909090909091161,0.45454545454545453032,3.40830219356252062113},
	{0.18181818181818182323,0.36363636363636364646,0.13179480820083266934},
	{0.27272727272727270709,0.27272727272727270709,2.94464891975306208849},
	{0.36363636363636364646,0.18181818181818182323,0.13179480820092637217},
	{0.45454545454545453032,0.09090909090909091161,3.40830219356252062113},
	{0.09090909090909091161,0.36363636363636364646,-2.75199487433857825636},
	{0.18181818181818182323,0.27272727272727270709,-1.03533041225747890479},
	{0.27272727272727270709,0.18181818181818182323,-1.03533041225737587610},
	{0.36363636363636364646,0.09090909090909091161,-2.75199487433857825636},
	{0.09090909090909091161,0.27272727272727270709,1.78954888668425371456},
	{0.18181818181818182323,0.18181818181818182323,0.50102899029964742539},
	{0.27272727272727270709,0.09090909090909091161,1.78954888668425371456},
	{0.09090909090909091161,0.18181818181818182323,-0.65220072751311242154},
	{0.18181818181818182323,0.09090909090909091161,-0.65220072751311242154},
	{0.09090909090909091161,0.09090909090909091161,0.28975005511461682239},};
template <>
std::vector<std::tuple<double, double, double>> IntegrationRule<9>::rule{
	{0.08333333333333332871,0.83333333333333337034,0.17834054834073465035},
	{0.16666666666666665741,0.75000000000000000000,-0.23086580086553865065},
	{0.25000000000000000000,0.66666666666666662966,0.57913419913431996022},
	{0.33333333333333331483,0.58333333333333337034,-0.48943722943714074169},
	{0.41666666666666668517,0.50000000000000000000,0.31008658008740686007},
	{0.50000000000000000000,0.41666666666666668517,0.31008658008746725621},
	{0.58333333333333337034,0.33333333333333331483,-0.48943722943719136786},
	{0.66666666666666662966,0.25000000000000000000,0.57913419913446473331},
	{0.75000000000000000000,0.16666666666666665741,-0.23086580086558261549},
	{0.83333333333333337034,0.08333333333333332871,0.17834054834073465035},
	{0.08333333333333332871,0.75000000000000000000,-0.23086580086553865065},
	{0.16666666666666665741,0.66666666666666662966,-0.50943722943754465859},
	{0.25000000000000000000,0.58333333333333337034,0.91627705627720601456},
	{0.33333333333333331483,0.50000000000000000000,-2.29705627705626191926},
	{0.41666666666666668517,0.41666666666666668517,2.35580086580105785288},
	{0.50000000000000000000,0.33333333333333331483,-2.29705627705630366364},
	{0.58333333333333337034,0.25000000000000000000,0.91627705627700883895},
	{0.66666666666666662966,0.16666666666666665741,-0.50943722943743807718},
	{0.75000000000000000000,0.08333333333333332871,-0.23086580086553865065},
	{0.08333333333333332871,0.66666666666666662966,0.57913419913431996022},
	{0.16666666666666665741,0.58333333333333337034,0.91627705627712074943},
	{0.25000000000000000000,0.50000000000000000000,0.08865800865823503241},
	{0.33333333333333331483,0.41666666666666668517,0.84865800865820795185},
	{0.41666666666666668517,0.33333333333333331483,0.84865800865832430322},
	{0.50000000000000000000,0.25000000000000000000,0.08865800865821904519},
	{0.58333333333333337034,0.16666666666666665741,0.91627705627674060906},
	{0.66666666666666662966,0.08333333333333332871,0.57913419913431996022},
	{0.08333333333333332871,0.58333333333333337034,-0.48943722943714074169},
	{0.16666666666666665741,0.50000000000000000000,-2.29705627705621928669},
	{0.25000000000000000000,0.41666666666666668517,0.84865800865798057817},
	{0.33333333333333331483,0.33333333333333331483,-3.16086580086590007710},
	{0.41666666666666668517,0.25000000000000000000,0.84865800865819107646},
	{0.50000000000000000000,0.16666666666666665741,-2.29705627705620196721},
	{0.58333333333333337034,0.08333333333333332871,-0.48943722943714074169},
	{0.08333333333333332871,0.50000000000000000000,0.31008658008740686007},
	{0.16666666666666665741,0.41666666666666668517,2.35580086580105074745},
	{0.25000000000000000000,0.33333333333333331483,0.84865800865819285281},
	{0.33333333333333331483,0.25000000000000000000,0.84865800865822038634},
	{0.41666666666666668517,0.16666666666666665741,2.35580086580077097125},
	{0.50000000000000000000,0.08333333333333332871,0.31008658008740686007},
	{0.08333333333333332871,0.41666666666666668517,0.31008658008746725621},
	{0.16666666666666665741,0.33333333333333331483,-2.29705627705617754231},
	{0.25000000000000000000,0.25000000000000000000,0.08865800865823858512},
	{0.33333333333333331483,0.16666666666666665741,-2.29705627705663628646},
	{0.41666666666666668517,0.08333333333333332871,0.31008658008746725621},
	{0.08333333333333332871,0.33333333333333331483,-0.48943722943719136786},
	{0.16666666666666665741,0.25000000000000000000,0.91627705627702482616},
	{0.25000000000000000000,0.16666666666666665741,0.91627705627675481992},
	{0.33333333333333331483,0.08333333333333332871,-0.48943722943719136786},
	{0.08333333333333332871,0.25000000000000000000,0.57913419913446473331},
	{0.16666666666666665741,0.16666666666666665741,-0.50943722943760860744},
	{0.25000000000000000000,0.08333333333333332871,0.57913419913446473331},
	{0.08333333333333332871,0.16666666666666665741,-0.23086580086558261549},
	{0.16666666666666665741,0.08333333333333332871,-0.23086580086558261549},
	{0.08333333333333332871,0.08333333333333332871,0.17834054834073465035},};
};  // namespace space
